import{r as c,k as h,f as b,w as _,c as u,a as t,n as f,t as d,h as w,u as S,F as C,g as L,j as k,o as g,l as A}from"./index-DorqM7ya.js";import{s as F}from"./index-CyRPQyA5.js";import"./index-DJUY68fS.js";import"./index-ChQ6boSU.js";import"./index-CII8oppT.js";import"./index-CiwNahGm.js";const N={class:"p-4 flex flex-col gap-4"},D={class:"flex justify-between items-center mb-4"},R={class:"flex items-center gap-4"},T={class:"flex items-center gap-2"},V={class:"text-sm text-gray-400"},j={class:"flex items-center gap-2 px-3 py-1 bg-gray-800 rounded"},E={key:0,class:"flex justify-center items-center h-[600px]"},I={class:"text-gray-400"},O={class:"text-blue-300"},B={class:"text-white ml-2"},U={methods:{formatDate(n){const s=new Date(n);return isNaN(s.getTime())?n||"":s.toLocaleString("de-DE",{hour:"2-digit",minute:"2-digit",second:"2-digit"})},getLevelColor(n){switch(n){case"INFO":return"text-green-400";case"WARN":return"text-yellow-400";case"ERROR":return"text-red-400";case"FATAL":return"text-red-600";default:return"text-gray-400"}}}},G=Object.assign(U,{__name:"Logs",setup(n){const s=c([]),i=c(!1),r=c(localStorage.getItem("logsAutoScroll")!=="false"),p=c(null),l=c(null),x=()=>{r.value=!r.value,localStorage.setItem("logsAutoScroll",r.value.toString())},m=()=>{l.value&&l.value.close();try{l.value=new EventSource("/api/logs/stream",{withCredentials:!0}),l.value.onopen=()=>{i.value=!0},l.value.onmessage=o=>{try{const e=JSON.parse(o.data);Array.isArray(e)?s.value=e:e&&(s.value.push(e),s.value.length>500&&(s.value=s.value.slice(-500)))}catch(e){console.error("Failed to parse log data",e)}},l.value.onerror=()=>{i.value=!1,setTimeout(m,5e3)}}catch(o){console.error("Failed to connect to log stream",o),i.value=!1}},v=async()=>{try{const o=await k.get("/api/logs");s.value=o.data}catch(o){console.error("Failed to fetch initial logs",o)}};return h(()=>{v(),m()}),b(()=>{l.value&&l.value.close()}),_(s,()=>{r.value&&p.value&&A(()=>{p.value.scrollTop=p.value.scrollHeight})},{deep:!0}),(o,e)=>(g(),u("div",N,[t("div",D,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold"},"System Logs",-1)),t("div",R,[t("div",T,[t("div",{class:f(["w-2 h-2 rounded-full",i.value?"bg-green-500":"bg-red-500"])},null,2),t("span",V,d(i.value?"Connected":"Disconnected"),1)]),t("div",j,[e[1]||(e[1]=t("i",{class:"pi pi-arrow-down text-sm text-gray-400"},null,-1)),w(S(F),{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),binary:"",onChange:x},null,8,["modelValue"]),e[2]||(e[2]=t("span",{class:"text-sm text-gray-400"},"Auto-Scroll",-1))]),t("button",{onClick:v,class:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"}," Refresh ")])]),s.value.length===0?(g(),u("div",E,[...e[4]||(e[4]=[t("div",{class:"text-center"},[t("i",{class:"pi pi-spin pi-spinner text-4xl text-blue-500"}),t("p",{class:"mt-4 text-gray-400"},"Loading logs...")],-1)])])):(g(),u("div",{key:1,ref_key:"logsContainer",ref:p,class:"bg-gray-800 rounded-lg p-4 font-mono text-sm h-[600px] overflow-y-auto"},[(g(!0),u(C,null,L(s.value,(a,y)=>(g(),u("div",{key:y,class:"mb-1 border-b border-gray-700 pb-1"},[t("span",I,"["+d(o.formatDate(a.time))+"]",1),t("span",{class:f([o.getLevelColor(a.level),"mx-2 font-bold"])},d(a.level),3),t("span",O,d(a.component)+":",1),t("span",B,d(a.message),1)]))),128))],512))]))}});export{G as default};
